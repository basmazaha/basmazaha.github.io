<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title data-ar="عيادة دكتور عمرو لطب وتجميل الأسنان | Dr Amr Dental Clinic"
         data-en="Dr Amr Dental Clinic | عيادة دكتور عمرو لطب وتجميل الأسنان">
         عيادة دكتور عمرو لطب وتجميل الأسنان | Dr Amr Dental Clinic
  </title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Cairo', sans-serif; line-height: 1.6; color: #333; background: #f9f9f9; }

    :root {
      --primary: #7ac8c0;
      --primary-dark: #5aa8a0;
      --primary-darker: #3a8880;
      --text-dark: #2a2a2a;
      --gray: #555;
      --whatsapp: #25D366;
      --whatsapp-dark: #1da851;
    }

    header { background: white; color: var(--primary-darker); text-align: center; padding: 70px 20px 50px; border-bottom: 1px solid rgba(122, 200, 192, 0.18); position: relative; }

    .lang-switcher { position: absolute; top: 20px; left: 20px; z-index: 10; }

    .lang-btn {
      background: var(--primary);
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 30px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      transition: all 0.3s;
    }

    .lang-btn:hover { background: var(--primary-dark); }

    html[dir="ltr"] .lang-switcher { left: auto; right: 20px; }

    .logo-container { margin-bottom: 1.8rem; }

    .logo-img { max-width: 140px; height: auto; display: block; margin: 0 auto; }

    header h1 { font-size: 2.8rem; margin-bottom: 0.9rem; color: var(--primary-darker); }

    header p { font-size: 1.3rem; margin-bottom: 2.2rem; max-width: 720px; margin-left: auto; margin-right: auto; color: var(--gray); }

    .btn {
      display: inline-block;
      background: var(--primary);
      color: white;
      padding: 14px 36px;
      border-radius: 50px;
      text-decoration: none;
      font-weight: 600;
      font-size: 1.1rem;
      transition: all 0.3s;
      border: none;
      cursor: pointer;
    }

    .btn:hover { background: var(--primary-dark); transform: translateY(-3px); box-shadow: 0 10px 25px rgba(0,0,0,0.15); }

    /* ── Booking Modal Styles ── */
    #booking-modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.7);
      z-index: 10000;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .modal-box {
      position: relative;
      background: white;
      border-radius: 16px;
      width: 100%;
      max-width: 1100px;
      height: 90vh;
      box-shadow: 0 20px 60px rgba(0,0,0,0.5);
      overflow: hidden;
    }

    .close-modal {
      position: absolute;
      top: 15px;
      right: 20px;
      font-size: 36px;
      color: #444;
      cursor: pointer;
      z-index: 20;
      background: rgba(255,255,255,0.9);
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      transition: 0.2s;
    }

    .close-modal:hover { transform: scale(1.1); background: #f8f8f8; }

    #booking-iframe {
      width: 100%;
      height: 100%;
      border: none;
    }

    .iframe-fallback {
      padding: 40px;
      text-align: center;
      font-size: 1.2rem;
      color: #555;
    }

    @media (max-width: 768px) {
      .modal-box { height: 95vh; }
    }
  </style>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>

  <!-- ... باقي محتوى الصفحة كما هو (header, sections, footer) ... -->

  <header>
    <!-- ... اللوجو والنص ... -->

    <button id="bookBtn" class="btn"
            data-ar="احجز موعد الآن"
            data-en="Book Now">
      احجز موعد الآن
    </button>
  </header>

  <!-- ... باقي الأقسام ... -->

  <!-- Booking Modal -->
  <div id="booking-modal">
    <div class="modal-box">
      <div class="close-modal" id="closeModal">&times;</div>
      <iframe id="booking-iframe" src="" allowfullscreen></iframe>
      <div id="iframe-fallback" class="iframe-fallback" style="display:none;">
        <p>عفوًا، لا يمكن عرض النافذة داخل الصفحة حاليًا.<br>
        <a href="#" id="openInNewTab" target="_blank">اضغط هنا لفتح صفحة الحجز في نافذة جديدة</a></p>
      </div>
    </div>
  </div>

  <script>
    const langToggle = document.getElementById('langToggle');
    const bookBtn    = document.getElementById('bookBtn');
    const modal      = document.getElementById('booking-modal');
    const closeBtn   = document.getElementById('closeModal');
    const iframe     = document.getElementById('booking-iframe');
    const fallback   = document.getElementById('iframe-fallback');
    const newTabLink = document.getElementById('openInNewTab');

    let currentLang = localStorage.getItem('lang') || 'ar';

    const bookingUrls = {
      ar: "https://dramrclinic.bookafy.com/service/-ad74?locale=ar",
      en: "https://dramrclinic.bookafy.com/service/booking-an-appointment?locale=en"
    };

    function setLanguage(lang) {
      currentLang = lang;
      localStorage.setItem('lang', lang);
      document.documentElement.lang = lang;
      document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';

      document.querySelectorAll('[data-ar][data-en]').forEach(el => {
        el.textContent = el.getAttribute(`data-${lang}`);
      });

      langToggle.textContent = lang === 'ar' ? 'English' : 'العربية';
      bookBtn.textContent = lang === 'ar' ? 'احجز موعد الآن' : 'Book Now';
    }

    setLanguage(currentLang);

    langToggle.addEventListener('click', () => {
      setLanguage(currentLang === 'ar' ? 'en' : 'ar');
    });

    // فتح المودال
    bookBtn.addEventListener('click', () => {
      const url = bookingUrls[currentLang];
      iframe.src = url;
      fallback.style.display = 'none';
      modal.style.display = 'flex';

      // إذا فشل الـ iframe (بعد ثوانٍ)
      iframe.onload = () => {
        // نجاح → إخفاء الفallback
      };
      setTimeout(() => {
        if (iframe.contentDocument === null || iframe.contentDocument.body.innerHTML === '') {
          fallback.style.display = 'block';
          newTabLink.href = url;
        }
      }, 5000);
    });

    // إغلاق
    closeBtn.addEventListener('click', closeBooking);
    modal.addEventListener('click', e => {
      if (e.target === modal) closeBooking();
    });

    function closeBooking() {
      modal.style.display = 'none';
      iframe.src = ''; // تنظيف
    }
  </script>

</body>
</html>
